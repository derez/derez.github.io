<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Bits on 0x42697473 - meltdown</title><link href="https://derez.github.io/" rel="alternate"></link><link href="https://derez.github.io/tag/meltdown/feed/index.xml" rel="self"></link><id>https://derez.github.io/</id><updated>2018-02-03T00:00:00-05:00</updated><entry><title>MeltdownÂ test</title><link href="https://derez.github.io/2018/meltdown.html" rel="alternate"></link><published>2018-02-03T00:00:00-05:00</published><updated>2018-02-03T00:00:00-05:00</updated><author><name>Danny Walker</name></author><id>tag:derez.github.io,2018-02-03:/2018/meltdown.html</id><summary type="html">&lt;p class="first last"&gt;Meltdown&amp;nbsp;test&lt;/p&gt;
</summary><content type="html">&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span id="row-1"&gt;&lt;span class="lineno"&gt;  1 &lt;/span&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-2"&gt;&lt;span class="lineno"&gt;  2 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-3"&gt;&lt;span class="lineno"&gt;  3 &lt;/span&gt;&lt;span class="c1"&gt;# Copyright (C) 2018  Red Hat, Inc.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-4"&gt;&lt;span class="lineno"&gt;  4 &lt;/span&gt;&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-5"&gt;&lt;span class="lineno"&gt;  5 &lt;/span&gt;&lt;span class="c1"&gt;# This program is free software: you can redistribute it and/or modify&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-6"&gt;&lt;span class="lineno"&gt;  6 &lt;/span&gt;&lt;span class="c1"&gt;# it under the terms of the GNU General Public License as published by&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-7"&gt;&lt;span class="lineno"&gt;  7 &lt;/span&gt;&lt;span class="c1"&gt;# the Free Software Foundation, either version 3 of the License, or&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-8"&gt;&lt;span class="lineno"&gt;  8 &lt;/span&gt;&lt;span class="c1"&gt;# (at your option) any later version.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-9"&gt;&lt;span class="lineno"&gt;  9 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-10"&gt;&lt;span class="lineno"&gt; 10 &lt;/span&gt;&lt;span class="c1"&gt;# Version: 2.1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-11"&gt;&lt;span class="lineno"&gt; 11 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-12"&gt;&lt;span class="lineno"&gt; 12 &lt;/span&gt;&lt;span class="c1"&gt;# Warning! Be sure to download the latest version of this script from its primary source:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-13"&gt;&lt;span class="lineno"&gt; 13 &lt;/span&gt;&lt;span class="c1"&gt;# https://access.redhat.com/security/vulnerabilities/speculativeexecution&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-14"&gt;&lt;span class="lineno"&gt; 14 &lt;/span&gt;&lt;span class="c1"&gt;# DO NOT blindly trust any internet sources and NEVER do `curl something | bash`!&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-15"&gt;&lt;span class="lineno"&gt; 15 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-16"&gt;&lt;span class="lineno"&gt; 16 &lt;/span&gt;&lt;span class="c1"&gt;# This script is meant for simple detection of the vulnerability. Feel free to modify it for your&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-17"&gt;&lt;span class="lineno"&gt; 17 &lt;/span&gt;&lt;span class="c1"&gt;# environment or needs. For more advanced detection, consider Red Hat Insights:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-18"&gt;&lt;span class="lineno"&gt; 18 &lt;/span&gt;&lt;span class="c1"&gt;# https://access.redhat.com/products/red-hat-insights#getstarted&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-19"&gt;&lt;span class="lineno"&gt; 19 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-20"&gt;&lt;span class="lineno"&gt; 20 &lt;/span&gt;&lt;span class="c1"&gt;# Checking against the list of vulnerable packages is necessary because of the way how features&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-21"&gt;&lt;span class="lineno"&gt; 21 &lt;/span&gt;&lt;span class="c1"&gt;# are back-ported to older versions of packages in various channels.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-22"&gt;&lt;span class="lineno"&gt; 22 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-23"&gt;&lt;span class="lineno"&gt; 23 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-24"&gt;&lt;span class="lineno"&gt; 24 &lt;/span&gt;basic_args&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-25"&gt;&lt;span class="lineno"&gt; 25 &lt;/span&gt;    &lt;span class="c1"&gt;# Parses basic commandline arguments and sets basic environment.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-26"&gt;&lt;span class="lineno"&gt; 26 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-27"&gt;&lt;span class="lineno"&gt; 27 &lt;/span&gt;    &lt;span class="c1"&gt;# Args:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-28"&gt;&lt;span class="lineno"&gt; 28 &lt;/span&gt;    &lt;span class="c1"&gt;#     parameters - an array of commandline arguments&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-29"&gt;&lt;span class="lineno"&gt; 29 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-30"&gt;&lt;span class="lineno"&gt; 30 &lt;/span&gt;    &lt;span class="c1"&gt;# Side effects:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-31"&gt;&lt;span class="lineno"&gt; 31 &lt;/span&gt;    &lt;span class="c1"&gt;#     Exits if --help parameters is used&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-32"&gt;&lt;span class="lineno"&gt; 32 &lt;/span&gt;    &lt;span class="c1"&gt;#     Sets COLOR constants and debug variable&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-33"&gt;&lt;span class="lineno"&gt; 33 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-34"&gt;&lt;span class="lineno"&gt; 34 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;parameters&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-35"&gt;&lt;span class="lineno"&gt; 35 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-36"&gt;&lt;span class="lineno"&gt; 36 &lt;/span&gt;    &lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;31m&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-37"&gt;&lt;span class="lineno"&gt; 37 &lt;/span&gt;    &lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;33m&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-38"&gt;&lt;span class="lineno"&gt; 38 &lt;/span&gt;    &lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;32m&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-39"&gt;&lt;span class="lineno"&gt; 39 &lt;/span&gt;    &lt;span class="nv"&gt;BOLD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1m&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-40"&gt;&lt;span class="lineno"&gt; 40 &lt;/span&gt;    &lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[0m&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-41"&gt;&lt;span class="lineno"&gt; 41 &lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; parameter in &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;[@]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;do&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-42"&gt;&lt;span class="lineno"&gt; 42 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-h&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--help&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-43"&gt;&lt;span class="lineno"&gt; 43 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Usage: &lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; basename &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt; [-n | --no-colors] [-d | --debug]&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-44"&gt;&lt;span class="lineno"&gt; 44 &lt;/span&gt;            &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-45"&gt;&lt;span class="lineno"&gt; 45 &lt;/span&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-n&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--no-colors&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-46"&gt;&lt;span class="lineno"&gt; 46 &lt;/span&gt;            &lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-47"&gt;&lt;span class="lineno"&gt; 47 &lt;/span&gt;            &lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-48"&gt;&lt;span class="lineno"&gt; 48 &lt;/span&gt;            &lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-49"&gt;&lt;span class="lineno"&gt; 49 &lt;/span&gt;            &lt;span class="nv"&gt;BOLD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-50"&gt;&lt;span class="lineno"&gt; 50 &lt;/span&gt;            &lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-51"&gt;&lt;span class="lineno"&gt; 51 &lt;/span&gt;        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-d&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$parameter&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--debug&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-52"&gt;&lt;span class="lineno"&gt; 52 &lt;/span&gt;            &lt;span class="nv"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-53"&gt;&lt;span class="lineno"&gt; 53 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-54"&gt;&lt;span class="lineno"&gt; 54 &lt;/span&gt;    &lt;span class="k"&gt;done&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-55"&gt;&lt;span class="lineno"&gt; 55 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-56"&gt;&lt;span class="lineno"&gt; 56 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-57"&gt;&lt;span class="lineno"&gt; 57 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-58"&gt;&lt;span class="lineno"&gt; 58 &lt;/span&gt;basic_reqs&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-59"&gt;&lt;span class="lineno"&gt; 59 &lt;/span&gt;    &lt;span class="c1"&gt;# Prints common disclaimer and checks basic requirements.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-60"&gt;&lt;span class="lineno"&gt; 60 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-61"&gt;&lt;span class="lineno"&gt; 61 &lt;/span&gt;    &lt;span class="c1"&gt;# Args:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-62"&gt;&lt;span class="lineno"&gt; 62 &lt;/span&gt;    &lt;span class="c1"&gt;#     CVE - string printed in the disclaimer&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-63"&gt;&lt;span class="lineno"&gt; 63 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-64"&gt;&lt;span class="lineno"&gt; 64 &lt;/span&gt;    &lt;span class="c1"&gt;# Side effects:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-65"&gt;&lt;span class="lineno"&gt; 65 &lt;/span&gt;    &lt;span class="c1"&gt;#     Exits when &amp;#39;rpm&amp;#39; command is not available&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-66"&gt;&lt;span class="lineno"&gt; 66 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-67"&gt;&lt;span class="lineno"&gt; 67 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;CVE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-68"&gt;&lt;span class="lineno"&gt; 68 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-69"&gt;&lt;span class="lineno"&gt; 69 &lt;/span&gt;    &lt;span class="c1"&gt;# Disclaimer&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-70"&gt;&lt;span class="lineno"&gt; 70 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-71"&gt;&lt;span class="lineno"&gt; 71 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BOLD&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;This script is primarily designed to detect &lt;/span&gt;&lt;span class="nv"&gt;$CVE&lt;/span&gt;&lt;span class="s2"&gt; on supported&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-72"&gt;&lt;span class="lineno"&gt; 72 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Red Hat Enterprise Linux systems and kernel packages.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-73"&gt;&lt;span class="lineno"&gt; 73 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Result may be inaccurate for other RPM based systems.&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-74"&gt;&lt;span class="lineno"&gt; 74 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-75"&gt;&lt;span class="lineno"&gt; 75 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-76"&gt;&lt;span class="lineno"&gt; 76 &lt;/span&gt;    &lt;span class="c1"&gt;# RPM is required&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-77"&gt;&lt;span class="lineno"&gt; 77 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; ! &lt;span class="nb"&gt;command&lt;/span&gt; -v rpm &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt; /dev/null&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-78"&gt;&lt;span class="lineno"&gt; 78 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;#39;rpm&amp;#39; command is required, but not installed. Exiting.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-79"&gt;&lt;span class="lineno"&gt; 79 &lt;/span&gt;        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-80"&gt;&lt;span class="lineno"&gt; 80 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-81"&gt;&lt;span class="lineno"&gt; 81 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-82"&gt;&lt;span class="lineno"&gt; 82 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-83"&gt;&lt;span class="lineno"&gt; 83 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-84"&gt;&lt;span class="lineno"&gt; 84 &lt;/span&gt;check_supported_kernel&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-85"&gt;&lt;span class="lineno"&gt; 85 &lt;/span&gt;    &lt;span class="c1"&gt;# Checks if running kernel is supported.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-86"&gt;&lt;span class="lineno"&gt; 86 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-87"&gt;&lt;span class="lineno"&gt; 87 &lt;/span&gt;    &lt;span class="c1"&gt;# Args:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-88"&gt;&lt;span class="lineno"&gt; 88 &lt;/span&gt;    &lt;span class="c1"&gt;#     running_kernel - kernel string as returned by &amp;#39;uname -r&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-89"&gt;&lt;span class="lineno"&gt; 89 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-90"&gt;&lt;span class="lineno"&gt; 90 &lt;/span&gt;    &lt;span class="c1"&gt;# Side effects:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-91"&gt;&lt;span class="lineno"&gt; 91 &lt;/span&gt;    &lt;span class="c1"&gt;#     Exits when running kernel is obviously not supported&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-92"&gt;&lt;span class="lineno"&gt; 92 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-93"&gt;&lt;span class="lineno"&gt; 93 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;running_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-94"&gt;&lt;span class="lineno"&gt; 94 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-95"&gt;&lt;span class="lineno"&gt; 95 &lt;/span&gt;    &lt;span class="c1"&gt;# Check supported platform&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-96"&gt;&lt;span class="lineno"&gt; 96 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; !&lt;span class="o"&gt;=&lt;/span&gt; *&lt;span class="s2"&gt;&amp;quot;.el&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;-7&lt;span class="o"&gt;]&lt;/span&gt;* &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-97"&gt;&lt;span class="lineno"&gt; 97 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;This script is meant to be used only on Red Hat Enterprise Linux 5, 6 and 7.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-98"&gt;&lt;span class="lineno"&gt; 98 &lt;/span&gt;        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-99"&gt;&lt;span class="lineno"&gt; 99 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-100"&gt;&lt;span class="lineno"&gt;100 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-101"&gt;&lt;span class="lineno"&gt;101 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-102"&gt;&lt;span class="lineno"&gt;102 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-103"&gt;&lt;span class="lineno"&gt;103 &lt;/span&gt;get_rhel&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-104"&gt;&lt;span class="lineno"&gt;104 &lt;/span&gt;    &lt;span class="c1"&gt;# Gets RHEL number.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-105"&gt;&lt;span class="lineno"&gt;105 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-106"&gt;&lt;span class="lineno"&gt;106 &lt;/span&gt;    &lt;span class="c1"&gt;# Args:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-107"&gt;&lt;span class="lineno"&gt;107 &lt;/span&gt;    &lt;span class="c1"&gt;#     running_kernel - kernel string as returned by &amp;#39;uname -r&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-108"&gt;&lt;span class="lineno"&gt;108 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-109"&gt;&lt;span class="lineno"&gt;109 &lt;/span&gt;    &lt;span class="c1"&gt;# Prints:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-110"&gt;&lt;span class="lineno"&gt;110 &lt;/span&gt;    &lt;span class="c1"&gt;#     RHEL number, e.g. &amp;#39;5&amp;#39;, &amp;#39;6&amp;#39;, or &amp;#39;7&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-111"&gt;&lt;span class="lineno"&gt;111 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-112"&gt;&lt;span class="lineno"&gt;112 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;running_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-113"&gt;&lt;span class="lineno"&gt;113 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-114"&gt;&lt;span class="lineno"&gt;114 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;rhel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; sed -r -n &lt;span class="s1"&gt;&amp;#39;s/^.*el([[:digit:]]).*$/\1/p&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-115"&gt;&lt;span class="lineno"&gt;115 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$rhel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-116"&gt;&lt;span class="lineno"&gt;116 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-117"&gt;&lt;span class="lineno"&gt;117 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-118"&gt;&lt;span class="lineno"&gt;118 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-119"&gt;&lt;span class="lineno"&gt;119 &lt;/span&gt;check_cpu_vendor&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-120"&gt;&lt;span class="lineno"&gt;120 &lt;/span&gt;    &lt;span class="c1"&gt;# Checks for supported CPU vendor.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-121"&gt;&lt;span class="lineno"&gt;121 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-122"&gt;&lt;span class="lineno"&gt;122 &lt;/span&gt;    &lt;span class="c1"&gt;# Prints:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-123"&gt;&lt;span class="lineno"&gt;123 &lt;/span&gt;    &lt;span class="c1"&gt;#     &amp;#39;Intel&amp;#39; or &amp;#39;AMD&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-124"&gt;&lt;span class="lineno"&gt;124 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-125"&gt;&lt;span class="lineno"&gt;125 &lt;/span&gt;    &lt;span class="c1"&gt;# Returns:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-126"&gt;&lt;span class="lineno"&gt;126 &lt;/span&gt;    &lt;span class="c1"&gt;#     0 if supported CPU vendor found, otherwise 1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-127"&gt;&lt;span class="lineno"&gt;127 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-128"&gt;&lt;span class="lineno"&gt;128 &lt;/span&gt;    &lt;span class="c1"&gt;# Notes:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-129"&gt;&lt;span class="lineno"&gt;129 &lt;/span&gt;    &lt;span class="c1"&gt;#     MOCK_CPU_INFO_PATH can be used to mock /proc/cpuinfo file&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-130"&gt;&lt;span class="lineno"&gt;130 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-131"&gt;&lt;span class="lineno"&gt;131 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;cpuinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MOCK_CPU_INFO_PATH&lt;/span&gt;&lt;span class="k"&gt;:-&lt;/span&gt;&lt;span class="p"&gt;/proc/cpuinfo&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-132"&gt;&lt;span class="lineno"&gt;132 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-133"&gt;&lt;span class="lineno"&gt;133 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; grep --quiet &lt;span class="s2"&gt;&amp;quot;GenuineIntel&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$cpuinfo&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-134"&gt;&lt;span class="lineno"&gt;134 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Intel&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-135"&gt;&lt;span class="lineno"&gt;135 &lt;/span&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-136"&gt;&lt;span class="lineno"&gt;136 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-137"&gt;&lt;span class="lineno"&gt;137 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; grep --quiet &lt;span class="s2"&gt;&amp;quot;AuthenticAMD&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$cpuinfo&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-138"&gt;&lt;span class="lineno"&gt;138 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AMD&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-139"&gt;&lt;span class="lineno"&gt;139 &lt;/span&gt;        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-140"&gt;&lt;span class="lineno"&gt;140 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-141"&gt;&lt;span class="lineno"&gt;141 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-142"&gt;&lt;span class="lineno"&gt;142 &lt;/span&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-143"&gt;&lt;span class="lineno"&gt;143 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-144"&gt;&lt;span class="lineno"&gt;144 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-145"&gt;&lt;span class="lineno"&gt;145 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-146"&gt;&lt;span class="lineno"&gt;146 &lt;/span&gt;gather_info&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-147"&gt;&lt;span class="lineno"&gt;147 &lt;/span&gt;    &lt;span class="c1"&gt;# Gathers all available information and stores it in global variables.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-148"&gt;&lt;span class="lineno"&gt;148 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-149"&gt;&lt;span class="lineno"&gt;149 &lt;/span&gt;    &lt;span class="c1"&gt;# Side effects:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-150"&gt;&lt;span class="lineno"&gt;150 &lt;/span&gt;    &lt;span class="c1"&gt;#     Sets many global boolean flags&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-151"&gt;&lt;span class="lineno"&gt;151 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-152"&gt;&lt;span class="lineno"&gt;152 &lt;/span&gt;    &lt;span class="c1"&gt;# Notes:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-153"&gt;&lt;span class="lineno"&gt;153 &lt;/span&gt;    &lt;span class="c1"&gt;#     MOCK_DEBUG_X86_PATH can be used to mock /sys/kernel/debug/x86 directory&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-154"&gt;&lt;span class="lineno"&gt;154 &lt;/span&gt;    &lt;span class="c1"&gt;#     MOCK_CMDLINE_PATH can be used to mock /proc/cmdline file&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-155"&gt;&lt;span class="lineno"&gt;155 &lt;/span&gt;    &lt;span class="c1"&gt;#     MOCK_EUID can be used to mock EUID variable&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-156"&gt;&lt;span class="lineno"&gt;156 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-157"&gt;&lt;span class="lineno"&gt;157 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MOCK_DEBUG_X86_PATH&lt;/span&gt;&lt;span class="k"&gt;:-&lt;/span&gt;&lt;span class="p"&gt;/sys/kernel/debug/x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-158"&gt;&lt;span class="lineno"&gt;158 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;cmdline_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MOCK_CMDLINE_PATH&lt;/span&gt;&lt;span class="k"&gt;:-&lt;/span&gt;&lt;span class="p"&gt;/proc/cmdline&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-159"&gt;&lt;span class="lineno"&gt;159 &lt;/span&gt;    &lt;span class="nb"&gt;local&lt;/span&gt; &lt;span class="nv"&gt;euid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;MOCK_EUID&lt;/span&gt;&lt;span class="k"&gt;:-&lt;/span&gt;&lt;span class="nv"&gt;$EUID&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-160"&gt;&lt;span class="lineno"&gt;160 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-161"&gt;&lt;span class="lineno"&gt;161 &lt;/span&gt;    &lt;span class="c1"&gt;# Am I root?&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-162"&gt;&lt;span class="lineno"&gt;162 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;euid&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-163"&gt;&lt;span class="lineno"&gt;163 &lt;/span&gt;        &lt;span class="nv"&gt;root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-164"&gt;&lt;span class="lineno"&gt;164 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-165"&gt;&lt;span class="lineno"&gt;165 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-166"&gt;&lt;span class="lineno"&gt;166 &lt;/span&gt;    &lt;span class="c1"&gt;# Is debugfs mounted?&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-167"&gt;&lt;span class="lineno"&gt;167 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; mount &lt;span class="p"&gt;|&lt;/span&gt; grep --quiet debugfs&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-168"&gt;&lt;span class="lineno"&gt;168 &lt;/span&gt;        &lt;span class="nv"&gt;mounted_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-169"&gt;&lt;span class="lineno"&gt;169 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-170"&gt;&lt;span class="lineno"&gt;170 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-171"&gt;&lt;span class="lineno"&gt;171 &lt;/span&gt;    &lt;span class="c1"&gt;# Will fallback detection be needed?&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-172"&gt;&lt;span class="lineno"&gt;172 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! mounted_debugfs &lt;span class="o"&gt;||&lt;/span&gt; ! root &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-173"&gt;&lt;span class="lineno"&gt;173 &lt;/span&gt;        &lt;span class="nv"&gt;fallback_needed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-174"&gt;&lt;span class="lineno"&gt;174 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-175"&gt;&lt;span class="lineno"&gt;175 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-176"&gt;&lt;span class="lineno"&gt;176 &lt;/span&gt;    &lt;span class="c1"&gt;# Are all debug files accessible?&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-177"&gt;&lt;span class="lineno"&gt;177 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; -r &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/pti_enabled&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; -r &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/ibpb_enabled&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; -r &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/ibrs_enabled&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-178"&gt;&lt;span class="lineno"&gt;178 &lt;/span&gt;        &lt;span class="nv"&gt;all_debug_files&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-179"&gt;&lt;span class="lineno"&gt;179 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-180"&gt;&lt;span class="lineno"&gt;180 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-181"&gt;&lt;span class="lineno"&gt;181 &lt;/span&gt;    &lt;span class="c1"&gt;# Read features from debugfs&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-182"&gt;&lt;span class="lineno"&gt;182 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; all_debug_files &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-183"&gt;&lt;span class="lineno"&gt;183 &lt;/span&gt;        &lt;span class="nv"&gt;new_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-184"&gt;&lt;span class="lineno"&gt;184 &lt;/span&gt;        &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; &amp;lt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/pti_enabled&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-185"&gt;&lt;span class="lineno"&gt;185 &lt;/span&gt;        &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; &amp;lt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/ibpb_enabled&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-186"&gt;&lt;span class="lineno"&gt;186 &lt;/span&gt;        &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; &amp;lt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;debug_x86&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/ibrs_enabled&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-187"&gt;&lt;span class="lineno"&gt;187 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-188"&gt;&lt;span class="lineno"&gt;188 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-189"&gt;&lt;span class="lineno"&gt;189 &lt;/span&gt;    &lt;span class="c1"&gt;# Read features from dmesg&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-190"&gt;&lt;span class="lineno"&gt;190 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; ! dmesg &lt;span class="p"&gt;|&lt;/span&gt; grep --quiet &lt;span class="s1"&gt;&amp;#39;Linux.version&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-191"&gt;&lt;span class="lineno"&gt;191 &lt;/span&gt;        &lt;span class="nv"&gt;dmesg_wrapped&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-192"&gt;&lt;span class="lineno"&gt;192 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-193"&gt;&lt;span class="lineno"&gt;193 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-194"&gt;&lt;span class="lineno"&gt;194 &lt;/span&gt;    &lt;span class="c1"&gt;# These will not appear if disabled from commandline&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-195"&gt;&lt;span class="lineno"&gt;195 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; dmesg &lt;span class="p"&gt;|&lt;/span&gt; grep --quiet -e &lt;span class="s1"&gt;&amp;#39;x86/pti: Unmapping kernel while in userspace&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-196"&gt;&lt;span class="lineno"&gt;196 &lt;/span&gt;                            -e &lt;span class="s1"&gt;&amp;#39;x86/pti: Kernel page table isolation enabled&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-197"&gt;&lt;span class="lineno"&gt;197 &lt;/span&gt;                            -e &lt;span class="s1"&gt;&amp;#39;x86/pti: Xen PV detected, disabling&amp;#39;&lt;/span&gt; &lt;span class="se"&gt;\&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-198"&gt;&lt;span class="lineno"&gt;198 &lt;/span&gt;                            -e &lt;span class="s1"&gt;&amp;#39;x86/pti: Xen PV detected, disabling PTI protection&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-199"&gt;&lt;span class="lineno"&gt;199 &lt;/span&gt;        &lt;span class="nv"&gt;new_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-200"&gt;&lt;span class="lineno"&gt;200 &lt;/span&gt;        &lt;span class="nv"&gt;pti_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-201"&gt;&lt;span class="lineno"&gt;201 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-202"&gt;&lt;span class="lineno"&gt;202 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-203"&gt;&lt;span class="lineno"&gt;203 &lt;/span&gt;    &lt;span class="c1"&gt;# These will appear if disabled from commandline&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-204"&gt;&lt;span class="lineno"&gt;204 &lt;/span&gt;    &lt;span class="nv"&gt;line&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; dmesg &lt;span class="p"&gt;|&lt;/span&gt; tac &lt;span class="p"&gt;|&lt;/span&gt; grep --max-count &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;FEATURE SPEC_CTRL&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# Check last&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-205"&gt;&lt;span class="lineno"&gt;205 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$line&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-206"&gt;&lt;span class="lineno"&gt;206 &lt;/span&gt;        &lt;span class="nv"&gt;new_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-207"&gt;&lt;span class="lineno"&gt;207 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; ! grep --quiet &lt;span class="s1"&gt;&amp;#39;Not Present&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$line&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-208"&gt;&lt;span class="lineno"&gt;208 &lt;/span&gt;            &lt;span class="nv"&gt;ibrs_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-209"&gt;&lt;span class="lineno"&gt;209 &lt;/span&gt;            &lt;span class="nv"&gt;hw_support&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-210"&gt;&lt;span class="lineno"&gt;210 &lt;/span&gt;        &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-211"&gt;&lt;span class="lineno"&gt;211 &lt;/span&gt;            &lt;span class="nv"&gt;not_ibrs_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-212"&gt;&lt;span class="lineno"&gt;212 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-213"&gt;&lt;span class="lineno"&gt;213 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-214"&gt;&lt;span class="lineno"&gt;214 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-215"&gt;&lt;span class="lineno"&gt;215 &lt;/span&gt;    &lt;span class="nv"&gt;line&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; dmesg &lt;span class="p"&gt;|&lt;/span&gt; tac &lt;span class="p"&gt;|&lt;/span&gt; grep --max-count &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;FEATURE IBPB_SUPPORT&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# Check last&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-216"&gt;&lt;span class="lineno"&gt;216 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$line&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-217"&gt;&lt;span class="lineno"&gt;217 &lt;/span&gt;        &lt;span class="nv"&gt;new_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-218"&gt;&lt;span class="lineno"&gt;218 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; ! grep --quiet &lt;span class="s1"&gt;&amp;#39;Not Present&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$line&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-219"&gt;&lt;span class="lineno"&gt;219 &lt;/span&gt;            &lt;span class="nv"&gt;ibpb_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-220"&gt;&lt;span class="lineno"&gt;220 &lt;/span&gt;            &lt;span class="nv"&gt;hw_support&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-221"&gt;&lt;span class="lineno"&gt;221 &lt;/span&gt;        &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-222"&gt;&lt;span class="lineno"&gt;222 &lt;/span&gt;            &lt;span class="nv"&gt;not_ibpb_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-223"&gt;&lt;span class="lineno"&gt;223 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-224"&gt;&lt;span class="lineno"&gt;224 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-225"&gt;&lt;span class="lineno"&gt;225 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-226"&gt;&lt;span class="lineno"&gt;226 &lt;/span&gt;    &lt;span class="c1"&gt;# Read commandline&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-227"&gt;&lt;span class="lineno"&gt;227 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; grep --quiet &lt;span class="s1"&gt;&amp;#39;nopti&amp;#39;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$cmdline_path&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-228"&gt;&lt;span class="lineno"&gt;228 &lt;/span&gt;        &lt;span class="nv"&gt;nopti&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-229"&gt;&lt;span class="lineno"&gt;229 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-230"&gt;&lt;span class="lineno"&gt;230 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; grep --quiet &lt;span class="s1"&gt;&amp;#39;noibrs&amp;#39;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$cmdline_path&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-231"&gt;&lt;span class="lineno"&gt;231 &lt;/span&gt;        &lt;span class="nv"&gt;noibrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-232"&gt;&lt;span class="lineno"&gt;232 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-233"&gt;&lt;span class="lineno"&gt;233 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; grep --quiet &lt;span class="s1"&gt;&amp;#39;noibpb&amp;#39;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$cmdline_path&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-234"&gt;&lt;span class="lineno"&gt;234 &lt;/span&gt;        &lt;span class="nv"&gt;noibpb&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-235"&gt;&lt;span class="lineno"&gt;235 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-236"&gt;&lt;span class="lineno"&gt;236 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-237"&gt;&lt;span class="lineno"&gt;237 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-238"&gt;&lt;span class="lineno"&gt;238 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-239"&gt;&lt;span class="lineno"&gt;239 &lt;/span&gt;check_variants&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-240"&gt;&lt;span class="lineno"&gt;240 &lt;/span&gt;    &lt;span class="c1"&gt;# Checks which variants are mitigated based on many global boolean flags.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-241"&gt;&lt;span class="lineno"&gt;241 &lt;/span&gt;    &lt;span class="c1"&gt;#&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-242"&gt;&lt;span class="lineno"&gt;242 &lt;/span&gt;    &lt;span class="c1"&gt;# Side effects:&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-243"&gt;&lt;span class="lineno"&gt;243 &lt;/span&gt;    &lt;span class="c1"&gt;#     Sets global variables variant_1, variant_2, variant_3.&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-244"&gt;&lt;span class="lineno"&gt;244 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-245"&gt;&lt;span class="lineno"&gt;245 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; new_kernel &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-246"&gt;&lt;span class="lineno"&gt;246 &lt;/span&gt;        &lt;span class="nv"&gt;variant_1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-247"&gt;&lt;span class="lineno"&gt;247 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-248"&gt;&lt;span class="lineno"&gt;248 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-249"&gt;&lt;span class="lineno"&gt;249 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$vendor&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Intel&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-250"&gt;&lt;span class="lineno"&gt;250 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! fallback_needed &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-251"&gt;&lt;span class="lineno"&gt;251 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-252"&gt;&lt;span class="lineno"&gt;252 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-253"&gt;&lt;span class="lineno"&gt;253 &lt;/span&gt;                &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-254"&gt;&lt;span class="lineno"&gt;254 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-255"&gt;&lt;span class="lineno"&gt;255 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-256"&gt;&lt;span class="lineno"&gt;256 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-257"&gt;&lt;span class="lineno"&gt;257 &lt;/span&gt;                &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-258"&gt;&lt;span class="lineno"&gt;258 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-259"&gt;&lt;span class="lineno"&gt;259 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-260"&gt;&lt;span class="lineno"&gt;260 &lt;/span&gt;                &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-261"&gt;&lt;span class="lineno"&gt;261 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-262"&gt;&lt;span class="lineno"&gt;262 &lt;/span&gt;        &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-263"&gt;&lt;span class="lineno"&gt;263 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ibrs_dmesg &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; ibpb_dmesg &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; ! noibrs &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; ! noibpb &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-264"&gt;&lt;span class="lineno"&gt;264 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-265"&gt;&lt;span class="lineno"&gt;265 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-266"&gt;&lt;span class="lineno"&gt;266 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; pti_dmesg &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-267"&gt;&lt;span class="lineno"&gt;267 &lt;/span&gt;                &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-268"&gt;&lt;span class="lineno"&gt;268 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-269"&gt;&lt;span class="lineno"&gt;269 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-270"&gt;&lt;span class="lineno"&gt;270 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-271"&gt;&lt;span class="lineno"&gt;271 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-272"&gt;&lt;span class="lineno"&gt;272 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$vendor&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AMD&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-273"&gt;&lt;span class="lineno"&gt;273 &lt;/span&gt;        &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;AMD is not vulnerable to this variant&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-274"&gt;&lt;span class="lineno"&gt;274 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-275"&gt;&lt;span class="lineno"&gt;275 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! fallback_needed &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-276"&gt;&lt;span class="lineno"&gt;276 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-277"&gt;&lt;span class="lineno"&gt;277 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-278"&gt;&lt;span class="lineno"&gt;278 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-279"&gt;&lt;span class="lineno"&gt;279 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-280"&gt;&lt;span class="lineno"&gt;280 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-281"&gt;&lt;span class="lineno"&gt;281 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-282"&gt;&lt;span class="lineno"&gt;282 &lt;/span&gt;        &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-283"&gt;&lt;span class="lineno"&gt;283 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ibpb_dmesg &lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt; ! noibpb &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-284"&gt;&lt;span class="lineno"&gt;284 &lt;/span&gt;                &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Mitigated&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-285"&gt;&lt;span class="lineno"&gt;285 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-286"&gt;&lt;span class="lineno"&gt;286 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-287"&gt;&lt;span class="lineno"&gt;287 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-288"&gt;&lt;span class="lineno"&gt;288 &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-289"&gt;&lt;span class="lineno"&gt;289 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-290"&gt;&lt;span class="lineno"&gt;290 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-291"&gt;&lt;span class="lineno"&gt;291 &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BASH_SOURCE&lt;/span&gt;&lt;span class="p"&gt;[0]&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-292"&gt;&lt;span class="lineno"&gt;292 &lt;/span&gt;    basic_args &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$@&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-293"&gt;&lt;span class="lineno"&gt;293 &lt;/span&gt;    basic_reqs &lt;span class="s2"&gt;&amp;quot;Spectre / Meltdown&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-294"&gt;&lt;span class="lineno"&gt;294 &lt;/span&gt;    &lt;span class="nv"&gt;running_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; uname -r &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-295"&gt;&lt;span class="lineno"&gt;295 &lt;/span&gt;    check_supported_kernel &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-296"&gt;&lt;span class="lineno"&gt;296 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-297"&gt;&lt;span class="lineno"&gt;297 &lt;/span&gt;    &lt;span class="nv"&gt;rhel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; get_rhel &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-298"&gt;&lt;span class="lineno"&gt;298 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;rhel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-299"&gt;&lt;span class="lineno"&gt;299 &lt;/span&gt;        &lt;span class="nb"&gt;export&lt;/span&gt; &lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/sbin&amp;#39;&lt;/span&gt;:&lt;span class="nv"&gt;$PATH&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-300"&gt;&lt;span class="lineno"&gt;300 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-301"&gt;&lt;span class="lineno"&gt;301 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;RHEL5 is not supported by the script at the moment.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-302"&gt;&lt;span class="lineno"&gt;302 &lt;/span&gt;        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-303"&gt;&lt;span class="lineno"&gt;303 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-304"&gt;&lt;span class="lineno"&gt;304 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-305"&gt;&lt;span class="lineno"&gt;305 &lt;/span&gt;    &lt;span class="nv"&gt;vendor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt; check_cpu_vendor &lt;span class="k"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-306"&gt;&lt;span class="lineno"&gt;306 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-307"&gt;&lt;span class="lineno"&gt;307 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Your CPU vendor is not supported by the script at the moment.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-308"&gt;&lt;span class="lineno"&gt;308 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Only Intel and AMD are supported for now.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-309"&gt;&lt;span class="lineno"&gt;309 &lt;/span&gt;        &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-310"&gt;&lt;span class="lineno"&gt;310 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-311"&gt;&lt;span class="lineno"&gt;311 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-312"&gt;&lt;span class="lineno"&gt;312 &lt;/span&gt;    &lt;span class="nv"&gt;root&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-313"&gt;&lt;span class="lineno"&gt;313 &lt;/span&gt;    &lt;span class="nv"&gt;mounted_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-314"&gt;&lt;span class="lineno"&gt;314 &lt;/span&gt;    &lt;span class="nv"&gt;all_debug_files&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-315"&gt;&lt;span class="lineno"&gt;315 &lt;/span&gt;    &lt;span class="nv"&gt;fallback_needed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-316"&gt;&lt;span class="lineno"&gt;316 &lt;/span&gt;    &lt;span class="nv"&gt;pti_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-317"&gt;&lt;span class="lineno"&gt;317 &lt;/span&gt;    &lt;span class="nv"&gt;ibrs_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-318"&gt;&lt;span class="lineno"&gt;318 &lt;/span&gt;    &lt;span class="nv"&gt;ibpb_debugfs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-319"&gt;&lt;span class="lineno"&gt;319 &lt;/span&gt;    &lt;span class="nv"&gt;dmesg_wrapped&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-320"&gt;&lt;span class="lineno"&gt;320 &lt;/span&gt;    &lt;span class="nv"&gt;pti_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-321"&gt;&lt;span class="lineno"&gt;321 &lt;/span&gt;    &lt;span class="nv"&gt;ibrs_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-322"&gt;&lt;span class="lineno"&gt;322 &lt;/span&gt;    &lt;span class="nv"&gt;ibpb_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-323"&gt;&lt;span class="lineno"&gt;323 &lt;/span&gt;    &lt;span class="nv"&gt;not_ibrs_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-324"&gt;&lt;span class="lineno"&gt;324 &lt;/span&gt;    &lt;span class="nv"&gt;not_ibpb_dmesg&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-325"&gt;&lt;span class="lineno"&gt;325 &lt;/span&gt;    &lt;span class="nv"&gt;new_kernel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-326"&gt;&lt;span class="lineno"&gt;326 &lt;/span&gt;    &lt;span class="nv"&gt;nopti&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-327"&gt;&lt;span class="lineno"&gt;327 &lt;/span&gt;    &lt;span class="nv"&gt;noibrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-328"&gt;&lt;span class="lineno"&gt;328 &lt;/span&gt;    &lt;span class="nv"&gt;noibpb&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-329"&gt;&lt;span class="lineno"&gt;329 &lt;/span&gt;    &lt;span class="nv"&gt;hw_support&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-330"&gt;&lt;span class="lineno"&gt;330 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-331"&gt;&lt;span class="lineno"&gt;331 &lt;/span&gt;    &lt;span class="nv"&gt;variant_1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-332"&gt;&lt;span class="lineno"&gt;332 &lt;/span&gt;    &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-333"&gt;&lt;span class="lineno"&gt;333 &lt;/span&gt;    &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-334"&gt;&lt;span class="lineno"&gt;334 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-335"&gt;&lt;span class="lineno"&gt;335 &lt;/span&gt;    &lt;span class="c1"&gt;# Tests&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-336"&gt;&lt;span class="lineno"&gt;336 &lt;/span&gt;    gather_info
&lt;/span&gt;&lt;span id="row-337"&gt;&lt;span class="lineno"&gt;337 &lt;/span&gt;    check_variants
&lt;/span&gt;&lt;span id="row-338"&gt;&lt;span class="lineno"&gt;338 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-339"&gt;&lt;span class="lineno"&gt;339 &lt;/span&gt;    &lt;span class="c1"&gt;# Debug prints&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-340"&gt;&lt;span class="lineno"&gt;340 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$debug&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-341"&gt;&lt;span class="lineno"&gt;341 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;running_kernel = *&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-342"&gt;&lt;span class="lineno"&gt;342 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;rhel = *&lt;/span&gt;&lt;span class="nv"&gt;$rhel&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-343"&gt;&lt;span class="lineno"&gt;343 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;vendor = *&lt;/span&gt;&lt;span class="nv"&gt;$vendor&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-344"&gt;&lt;span class="lineno"&gt;344 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;root = *&lt;/span&gt;&lt;span class="nv"&gt;$root&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-345"&gt;&lt;span class="lineno"&gt;345 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;mounted_debugfs = *&lt;/span&gt;&lt;span class="nv"&gt;$mounted_debugfs&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-346"&gt;&lt;span class="lineno"&gt;346 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;all_debug_files = *&lt;/span&gt;&lt;span class="nv"&gt;$all_debug_files&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-347"&gt;&lt;span class="lineno"&gt;347 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;fallback_needed = *&lt;/span&gt;&lt;span class="nv"&gt;$fallback_needed&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-348"&gt;&lt;span class="lineno"&gt;348 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pti_debugfs = *&lt;/span&gt;&lt;span class="nv"&gt;$pti_debugfs&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-349"&gt;&lt;span class="lineno"&gt;349 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ibrs_debugfs = *&lt;/span&gt;&lt;span class="nv"&gt;$ibrs_debugfs&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-350"&gt;&lt;span class="lineno"&gt;350 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ibpb_debugfs = *&lt;/span&gt;&lt;span class="nv"&gt;$ibpb_debugfs&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-351"&gt;&lt;span class="lineno"&gt;351 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;dmesg_wrapped = *&lt;/span&gt;&lt;span class="nv"&gt;$dmesg_wrapped&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-352"&gt;&lt;span class="lineno"&gt;352 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pti_dmesg = *&lt;/span&gt;&lt;span class="nv"&gt;$pti_dmesg&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-353"&gt;&lt;span class="lineno"&gt;353 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ibrs_dmesg = *&lt;/span&gt;&lt;span class="nv"&gt;$ibrs_dmesg&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-354"&gt;&lt;span class="lineno"&gt;354 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;ibpb_dmesg = *&lt;/span&gt;&lt;span class="nv"&gt;$ibpb_dmesg&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-355"&gt;&lt;span class="lineno"&gt;355 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;not_ibrs_dmesg = *&lt;/span&gt;&lt;span class="nv"&gt;$not_ibrs_dmesg&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-356"&gt;&lt;span class="lineno"&gt;356 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;not_ibpb_dmesg = *&lt;/span&gt;&lt;span class="nv"&gt;$not_ibpb_dmesg&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-357"&gt;&lt;span class="lineno"&gt;357 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;new_kernel = *&lt;/span&gt;&lt;span class="nv"&gt;$new_kernel&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-358"&gt;&lt;span class="lineno"&gt;358 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;nopti = *&lt;/span&gt;&lt;span class="nv"&gt;$nopti&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-359"&gt;&lt;span class="lineno"&gt;359 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;noibrs = *&lt;/span&gt;&lt;span class="nv"&gt;$noibrs&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-360"&gt;&lt;span class="lineno"&gt;360 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;noibpb = *&lt;/span&gt;&lt;span class="nv"&gt;$noibpb&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-361"&gt;&lt;span class="lineno"&gt;361 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hw_support = *&lt;/span&gt;&lt;span class="nv"&gt;$hw_support&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-362"&gt;&lt;span class="lineno"&gt;362 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;variant_1 = *&lt;/span&gt;&lt;span class="nv"&gt;$variant_1&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-363"&gt;&lt;span class="lineno"&gt;363 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;variant_2 = *&lt;/span&gt;&lt;span class="nv"&gt;$variant_2&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-364"&gt;&lt;span class="lineno"&gt;364 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;variant_3 = *&lt;/span&gt;&lt;span class="nv"&gt;$variant_3&lt;/span&gt;&lt;span class="s2"&gt;*&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-365"&gt;&lt;span class="lineno"&gt;365 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-366"&gt;&lt;span class="lineno"&gt;366 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-367"&gt;&lt;span class="lineno"&gt;367 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-368"&gt;&lt;span class="lineno"&gt;368 &lt;/span&gt;    &lt;span class="c1"&gt;# Results&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-369"&gt;&lt;span class="lineno"&gt;369 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; new_kernel &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-370"&gt;&lt;span class="lineno"&gt;370 &lt;/span&gt;        &lt;span class="nv"&gt;kernel_with_patches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;OK&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-371"&gt;&lt;span class="lineno"&gt;371 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; hw_support &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-372"&gt;&lt;span class="lineno"&gt;372 &lt;/span&gt;            &lt;span class="nv"&gt;hw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;YES&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-373"&gt;&lt;span class="lineno"&gt;373 &lt;/span&gt;        &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-374"&gt;&lt;span class="lineno"&gt;374 &lt;/span&gt;            &lt;span class="nv"&gt;hw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;NO&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-375"&gt;&lt;span class="lineno"&gt;375 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-376"&gt;&lt;span class="lineno"&gt;376 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-377"&gt;&lt;span class="lineno"&gt;377 &lt;/span&gt;        &lt;span class="nv"&gt;kernel_with_patches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Not installed&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-378"&gt;&lt;span class="lineno"&gt;378 &lt;/span&gt;        &lt;span class="nv"&gt;hw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Cannot detect without updated kernel&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-379"&gt;&lt;span class="lineno"&gt;379 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-380"&gt;&lt;span class="lineno"&gt;380 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-381"&gt;&lt;span class="lineno"&gt;381 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; nopti &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-382"&gt;&lt;span class="lineno"&gt;382 &lt;/span&gt;        &lt;span class="nv"&gt;pti&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Disabled on kernel commandline by &amp;#39;nopti&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-383"&gt;&lt;span class="lineno"&gt;383 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-384"&gt;&lt;span class="lineno"&gt;384 &lt;/span&gt;        &lt;span class="nv"&gt;pti&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Not disabled on kernel commandline&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-385"&gt;&lt;span class="lineno"&gt;385 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-386"&gt;&lt;span class="lineno"&gt;386 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-387"&gt;&lt;span class="lineno"&gt;387 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; noibrs &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-388"&gt;&lt;span class="lineno"&gt;388 &lt;/span&gt;        &lt;span class="nv"&gt;ibrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Disabled on kernel commandline by &amp;#39;noibrs&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-389"&gt;&lt;span class="lineno"&gt;389 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-390"&gt;&lt;span class="lineno"&gt;390 &lt;/span&gt;        &lt;span class="nv"&gt;ibrs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Not disabled on kernel commandline&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-391"&gt;&lt;span class="lineno"&gt;391 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-392"&gt;&lt;span class="lineno"&gt;392 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-393"&gt;&lt;span class="lineno"&gt;393 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; noibpb &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-394"&gt;&lt;span class="lineno"&gt;394 &lt;/span&gt;        &lt;span class="nv"&gt;ibpb&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Disabled on kernel commandline by &amp;#39;noibpb&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-395"&gt;&lt;span class="lineno"&gt;395 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-396"&gt;&lt;span class="lineno"&gt;396 &lt;/span&gt;        &lt;span class="nv"&gt;ibpb&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Not disabled on kernel commandline&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-397"&gt;&lt;span class="lineno"&gt;397 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-398"&gt;&lt;span class="lineno"&gt;398 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-399"&gt;&lt;span class="lineno"&gt;399 &lt;/span&gt;    &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-400"&gt;&lt;span class="lineno"&gt;400 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$variant_1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-401"&gt;&lt;span class="lineno"&gt;401 &lt;/span&gt;        &lt;span class="o"&gt;((&lt;/span&gt; result &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-402"&gt;&lt;span class="lineno"&gt;402 &lt;/span&gt;        &lt;span class="nv"&gt;variant_1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_1&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-403"&gt;&lt;span class="lineno"&gt;403 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-404"&gt;&lt;span class="lineno"&gt;404 &lt;/span&gt;        &lt;span class="nv"&gt;variant_1&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_1&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-405"&gt;&lt;span class="lineno"&gt;405 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-406"&gt;&lt;span class="lineno"&gt;406 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$variant_2&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-407"&gt;&lt;span class="lineno"&gt;407 &lt;/span&gt;        &lt;span class="o"&gt;((&lt;/span&gt; result &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-408"&gt;&lt;span class="lineno"&gt;408 &lt;/span&gt;        &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_2&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-409"&gt;&lt;span class="lineno"&gt;409 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-410"&gt;&lt;span class="lineno"&gt;410 &lt;/span&gt;        &lt;span class="nv"&gt;variant_2&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_2&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-411"&gt;&lt;span class="lineno"&gt;411 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-412"&gt;&lt;span class="lineno"&gt;412 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$variant_3&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Vulnerable&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-413"&gt;&lt;span class="lineno"&gt;413 &lt;/span&gt;        &lt;span class="o"&gt;((&lt;/span&gt; result &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;8&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-414"&gt;&lt;span class="lineno"&gt;414 &lt;/span&gt;        &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_3&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-415"&gt;&lt;span class="lineno"&gt;415 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-416"&gt;&lt;span class="lineno"&gt;416 &lt;/span&gt;        &lt;span class="nv"&gt;variant_3&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$variant_3&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-417"&gt;&lt;span class="lineno"&gt;417 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-418"&gt;&lt;span class="lineno"&gt;418 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-419"&gt;&lt;span class="lineno"&gt;419 &lt;/span&gt;    &lt;span class="c1"&gt;# Output&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-420"&gt;&lt;span class="lineno"&gt;420 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Detected CPU vendor: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BOLD&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$vendor&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-421"&gt;&lt;span class="lineno"&gt;421 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Running kernel: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BOLD&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="nv"&gt;$running_kernel&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-422"&gt;&lt;span class="lineno"&gt;422 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-423"&gt;&lt;span class="lineno"&gt;423 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-424"&gt;&lt;span class="lineno"&gt;424 &lt;/span&gt;    &lt;span class="c1"&gt;# Warnings&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-425"&gt;&lt;span class="lineno"&gt;425 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; fallback_needed &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-426"&gt;&lt;span class="lineno"&gt;426 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Fallback non-runtime heuristics check is used (reading dmesg messages)&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;,&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-427"&gt;&lt;span class="lineno"&gt;427 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;because debugfs could not be read.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-428"&gt;&lt;span class="lineno"&gt;428 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-429"&gt;&lt;span class="lineno"&gt;429 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;To improve mitigation detection:&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-430"&gt;&lt;span class="lineno"&gt;430 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! mounted_debugfs &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-431"&gt;&lt;span class="lineno"&gt;431 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;* Mount debugfs by following command:&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-432"&gt;&lt;span class="lineno"&gt;432 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;rhel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="nv"&gt;rhel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;6&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-433"&gt;&lt;span class="lineno"&gt;433 &lt;/span&gt;                &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;    # mount -t debugfs nodev /sys/kernel/debug&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-434"&gt;&lt;span class="lineno"&gt;434 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-435"&gt;&lt;span class="lineno"&gt;435 &lt;/span&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; &lt;span class="nv"&gt;rhel&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="m"&gt;7&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-436"&gt;&lt;span class="lineno"&gt;436 &lt;/span&gt;                &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;    # systemctl restart sys-kernel-debug.mount&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-437"&gt;&lt;span class="lineno"&gt;437 &lt;/span&gt;            &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-438"&gt;&lt;span class="lineno"&gt;438 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-439"&gt;&lt;span class="lineno"&gt;439 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! root &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-440"&gt;&lt;span class="lineno"&gt;440 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;* Run this script with elevated privileges (e.g. as root)&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-441"&gt;&lt;span class="lineno"&gt;441 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-442"&gt;&lt;span class="lineno"&gt;442 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-443"&gt;&lt;span class="lineno"&gt;443 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-444"&gt;&lt;span class="lineno"&gt;444 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-445"&gt;&lt;span class="lineno"&gt;445 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; dmesg_wrapped &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-446"&gt;&lt;span class="lineno"&gt;446 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;It seems that dmesg circular buffer already wrapped,&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-447"&gt;&lt;span class="lineno"&gt;447 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;the results may be inaccurate.&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-448"&gt;&lt;span class="lineno"&gt;448 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-449"&gt;&lt;span class="lineno"&gt;449 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-450"&gt;&lt;span class="lineno"&gt;450 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-451"&gt;&lt;span class="lineno"&gt;451 &lt;/span&gt;    &lt;span class="c1"&gt;# Variants&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-452"&gt;&lt;span class="lineno"&gt;452 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Variant #1 (Spectre): &lt;/span&gt;&lt;span class="nv"&gt;$variant_1&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-453"&gt;&lt;span class="lineno"&gt;453 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;CVE-2017-5753 - speculative execution bounds-check bypass&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-454"&gt;&lt;span class="lineno"&gt;454 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - Kernel with mitigation patches: &lt;/span&gt;&lt;span class="nv"&gt;$kernel_with_patches&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-455"&gt;&lt;span class="lineno"&gt;455 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-456"&gt;&lt;span class="lineno"&gt;456 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-457"&gt;&lt;span class="lineno"&gt;457 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Variant #2 (Spectre): &lt;/span&gt;&lt;span class="nv"&gt;$variant_2&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-458"&gt;&lt;span class="lineno"&gt;458 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;CVE-2017-5715 - speculative execution branch target injection&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-459"&gt;&lt;span class="lineno"&gt;459 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - Kernel with mitigation patches: &lt;/span&gt;&lt;span class="nv"&gt;$kernel_with_patches&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-460"&gt;&lt;span class="lineno"&gt;460 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - HW support / updated microcode: &lt;/span&gt;&lt;span class="nv"&gt;$hw&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-461"&gt;&lt;span class="lineno"&gt;461 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - IBRS: &lt;/span&gt;&lt;span class="nv"&gt;$ibrs&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-462"&gt;&lt;span class="lineno"&gt;462 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - IBPB: &lt;/span&gt;&lt;span class="nv"&gt;$ibpb&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-463"&gt;&lt;span class="lineno"&gt;463 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-464"&gt;&lt;span class="lineno"&gt;464 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-465"&gt;&lt;span class="lineno"&gt;465 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;Variant #3 (Meltdown): &lt;/span&gt;&lt;span class="nv"&gt;$variant_3&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-466"&gt;&lt;span class="lineno"&gt;466 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;CVE-2017-5754 - speculative execution permission faults handling&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-467"&gt;&lt;span class="lineno"&gt;467 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$vendor&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;AMD&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-468"&gt;&lt;span class="lineno"&gt;468 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - AMD CPU: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;OK&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RESET&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-469"&gt;&lt;span class="lineno"&gt;469 &lt;/span&gt;    &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-470"&gt;&lt;span class="lineno"&gt;470 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - Kernel with mitigation patches: &lt;/span&gt;&lt;span class="nv"&gt;$kernel_with_patches&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-471"&gt;&lt;span class="lineno"&gt;471 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;   - PTI: &lt;/span&gt;&lt;span class="nv"&gt;$pti&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-472"&gt;&lt;span class="lineno"&gt;472 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-473"&gt;&lt;span class="lineno"&gt;473 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-474"&gt;&lt;span class="lineno"&gt;474 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-475"&gt;&lt;span class="lineno"&gt;475 &lt;/span&gt;    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; result !&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-476"&gt;&lt;span class="lineno"&gt;476 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Red Hat recommends that you:&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-477"&gt;&lt;span class="lineno"&gt;477 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! new_kernel &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-478"&gt;&lt;span class="lineno"&gt;478 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;* Update your kernel and reboot the system.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-479"&gt;&lt;span class="lineno"&gt;479 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-480"&gt;&lt;span class="lineno"&gt;480 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; ! hw_support &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-481"&gt;&lt;span class="lineno"&gt;481 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;* Ask your HW vendor for CPU microcode update.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-482"&gt;&lt;span class="lineno"&gt;482 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-483"&gt;&lt;span class="lineno"&gt;483 &lt;/span&gt;        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;((&lt;/span&gt; noibrs &lt;span class="o"&gt;||&lt;/span&gt; noibpb &lt;span class="o"&gt;||&lt;/span&gt; nopti &lt;span class="o"&gt;))&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-484"&gt;&lt;span class="lineno"&gt;484 &lt;/span&gt;            &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;* Remove kernel commandline options as noted above.&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-485"&gt;&lt;span class="lineno"&gt;485 &lt;/span&gt;        &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-486"&gt;&lt;span class="lineno"&gt;486 &lt;/span&gt;        &lt;span class="nb"&gt;echo&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-487"&gt;&lt;span class="lineno"&gt;487 &lt;/span&gt;    &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-488"&gt;&lt;span class="lineno"&gt;488 &lt;/span&gt;
&lt;/span&gt;&lt;span id="row-489"&gt;&lt;span class="lineno"&gt;489 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;For more information see:&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-490"&gt;&lt;span class="lineno"&gt;490 &lt;/span&gt;    &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;quot;https://access.redhat.com/security/vulnerabilities/speculativeexecution&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-491"&gt;&lt;span class="lineno"&gt;491 &lt;/span&gt;    &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$result&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;/span&gt;&lt;span id="row-492"&gt;&lt;span class="lineno"&gt;492 &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/pre&gt;&lt;/div&gt;
</content><category term="meltdown"></category><category term="code"></category><category term="bash"></category></entry></feed>